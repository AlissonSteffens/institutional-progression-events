<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<link rel="icon" type="image/png" href="assets/img/favicon.ico">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

	<title>Light Bootstrap Dashboard by Creative Tim</title>

	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="viewport" content="width=device-width" />


    <!-- Bootstrap core CSS     -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet" />

    <!-- Animation library for notifications   -->
    <link href="assets/css/animate.min.css" rel="stylesheet"/>

    <!--  Light Bootstrap Table core CSS    -->
    <link href="assets/css/light-bootstrap-dashboard.css" rel="stylesheet"/>

    <!-- Date Picker -->
    <!-- <link href="assets/css/bootstrap-datepicker.css" rel="stylesheet" />   -->

    <!--  Meu CSS    -->
    <link href="assets/css/styles.css" rel="stylesheet"/>

    <!--     Fonts and icons     -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,700,300' rel='stylesheet' type='text/css'>
    <link href="assets/css/pe-icon-7-stroke.css" rel="stylesheet" />

</head>
<body>

<div class="wrapper">
    <div class="sidebar" data-color="purple" data-image="assets/img/sidebar-4.jpg">

    <!--

        Tip 1: you can change the color of the sidebar using: data-color="blue | azure | green | orange | red | purple"
        Tip 2: you can also add an image using data-image tag

    -->

    	<div class="sidebar-wrapper">
            <div class="logo">
                <a href="http://www.creative-tim.com" class="simple-text">
                    PRI controller
                </a>
            </div>

            <ul class="nav">
                <li class="active">
                    <a href="index.html">
                        <i class="pe-7s-timer"></i>
                        <p>Eventos Cadastrados</p>
                    </a>
                    <a href="cadastrar.html">
                        <i class="pe-7s-alarm"></i>
                        <p>Cadastrar Eventos</p>
                    </a>
                    <a href="graficos.html">
                        <i class="pe-7s-graph"></i>
                        <p>Visualizar Graficos</p>
                    </a>
                    <a href="https://pri-demo.herokuapp.com">
                        <i class="pe-7s-display1"></i>
                        <p>Demonstração</p>
                    </a>
                </li>

            </ul>
    	</div>
    </div>

    <div class="main-panel">
        <nav class="navbar navbar-default navbar-fixed">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navigation-example-2">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="#">Controle de Progressão Institucional</a>
                </div>
            </div>
        </nav>
        <div class="content">
            <div class="container-fluid">
                <div class="row">
                    <button class="btn hide" id="but">Aqui</button>

                    <div class="col-md-12">
                        <div class="card">
                            <div class="header">
                                <h4 class="title">Cadastrar Eventos</h4>
                            </div>
                            <div class="content">
                                <form class="formulario" id="cadastro" novalidate="">
                                    <div class="row">
                                        <div class="col-md-12 mb-3">
                                            <label for="firstName">Nome Evento</label>
                                            <input type="text" class="form-control" id="nome-evento" placeholder="" value="" required="">
                                        </div>
                                    </div>
                                    <div class="row">
	                                        <div class="col-md-4 mb-3">
	                                            <label for="inicio">Data Início</label>
	                                            <input class="datepicker form-control" type="date" id="inicio"/>
	                                        </div>
	                                        <div class="col-md-4 mb-3">
	                                            <label for="fim">Data Fim</label>
	                                            <input class="datepicker form-control" type="date" id="fim"/>
	                                        </div>
	                                        <div class="col-md-4 mb-3">
	                                            <label for="limite">Período de avaliação</label>
	                                            <input class="form-control" type="number" value="0" id="limite"/>
                                        </div>
                                    </div>
                                    
                                    <div class="predominancia extensao mb-3">
                                        <h5>Predominancia em Extensão</h5>
                                        <div class="row">  
                                            <div class="col-md-4 mb-3">
                                                <label for="inicio">Pontuação Minima Extensão</label>
                                                <input class="datepicker form-control" type="number" value="0" id="ext-ext"/>
                                            </div>
                                            <div class="col-md-4 mb-3">
                                                <label for="fim">Pontuação Minima Pesquisa</label>
                                                <input class="datepicker form-control" type="number" value="0" id="ext-pes"/>
                                            </div>
                                            <div class="col-md-4 mb-3">
                                                <label for="limite">Pontuação Minima Ensino</label>
                                                <input class="datepicker form-control" type="number" value="0" id="ext-ens"/>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="predominancia ensino mb-3">
                                        <h5>Predominancia em Ensino</h5>
                                        <div class="row">  
                                            <div class="col-md-4 mb-3">
                                                <label for="inicio">Pontuação Minima Extensão</label>
                                                <input class="datepicker form-control" type="number" value="0" id="ens-ext"/>
                                            </div>
                                            <div class="col-md-4 mb-3">
                                                <label for="fim">Pontuação Minima Pesquisa</label>
                                                <input class="datepicker form-control" type="number" value="0" id="ens-pes"/>
                                            </div>
                                            <div class="col-md-4 mb-3">
                                                <label for="limite">Pontuação Minima Ensino</label>
                                                <input class="datepicker form-control" type="number" value="0" id="ens-ens"/>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="predominancia pesquisa mb-3">
                                        <h5>Predominancia em Pesquisa</h5>
                                        <div class="row">  
                                            <div class="col-md-4 mb-3">
                                                <label for="inicio">Pontuação Minima Extensão</label>
                                                <input class="datepicker form-control" type="number" value="0" id="pes-ext"/>
                                            </div>
                                            <div class="col-md-4 mb-3">
                                                <label for="fim">Pontuação Minima Pesquisa</label>
                                                <input class="datepicker form-control" type="number" value="0" id="pes-pes"/>
                                            </div>
                                            <div class="col-md-4 mb-3">
                                                <label for="limite">Pontuação Minima Ensino</label>
                                                <input class="datepicker form-control" type="number" value="0" id="pes-ens"/>
                                            </div>
                                        </div>
                                    </div>
                                    <hr class="mb-4">
                                    <button class="btn btn-primary btn-lg btn-block" type="button" id="continue">Cadastrar</button>
                                </form>
                                <div class="footer">
                                </div>         
                            </div>             
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <footer class="footer">
            <div class="container-fluid">
                <p class="copyright pull-right">
                    &copy; 2018 <i class="text-info">&lt; &gt;</i> with <i class="text-danger">&hearts;</i> by <a href="http://lite.acad.univali.br/pt/">lite</a>
                </p>
            </div>
        </footer>

    </div>
</div>


</body>

    <!--   Core JS Files   -->
    <script src="assets/js/jquery-1.10.2.js" type="text/javascript"></script>
    <script src="assets/js/bootstrap.min.js" type="text/javascript"></script>    

	<!--  Checkbox, Radio & Switch Plugins -->
	<script src="assets/js/bootstrap-checkbox-radio-switch.js"></script>

	<!--  Charts Plugin -->
	<script src="assets/js/chartist.min.js"></script>

    <!--  Notifications Plugin    -->
    <script src="assets/js/bootstrap-notify.js"></script>

    <!-- Date Picker -->
    <!-- <script src="assets/js/bootstrap-datepicker.js"></script> -->

    <!--  Google Maps Plugin    -->
    <!-- <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?sensor=false"></script> -->

    <!-- Light Bootstrap Table Core javascript and methods for Demo purpose -->
	<script src="assets/js/light-bootstrap-dashboard.js"></script>

    <!-- Light Bootstrap Table DEMO methods, don't include it in your project! -->
    <script>
        $('#continue').click(function (evt) {
            if(validar()){
                addEvent()
            }

            evt.preventDefault()            
            return false
        })

		function validar(){		
			var nome = document.getElementById('nome-evento');
			
			var inicio = document.getElementById('inicio');
			var fim = document.getElementById('fim');
			var limite = document.getElementById('limite');

			var extext = document.getElementById('ext-ext');
			var extpes = document.getElementById('ext-pes');
			var extens = document.getElementById('ext-ens');

			var ensext = document.getElementById('ens-ext');
			var enspes = document.getElementById('ens-pes');
			var ensens = document.getElementById('ens-ens');

			var pesext = document.getElementById('pes-ext');
			var pespes = document.getElementById('pes-pes');
			var pesens = document.getElementById('pes-ens');

			if(nome.value == ""){
				//alert(msg);
				$.notify({
                    icon: 'pe-7s-attention',
                    message: "Erro ao cadastrar evento: O nome deve ser informado"
                },{
                    type: 'danger',
                    timer: 4000
                });
				return false;
			}
			
            if(!VerificarData(inicio.value) || !VerificarData(fim.value)){
                //alert(msg);
                $.notify({
                    icon: 'pe-7s-attention',
                    message: "Erro ao cadastrar evento: A data deve ser informada"
                },{
                    type: 'danger',
                    timer: 4000
                });   
                return false;
            }

            if(limite.value <= 0){
                $.notify({
                    icon: 'pe-7s-attention',
                    message: "Erro ao cadastrar evento: Período de avaliação inválido"
                },{
                    type: 'danger',
                    timer: 4000
                });   
                return false;
            }

            // if(inicio.value >= fim.value){
                //alert(msg);
                // alert("Data de inicio maior que a final");    
                // return false;
            // }

			if(extext.value < 0 || extpes.value < 0 || extens.value < 0){
				//alert(msg);
				$.notify({
                    icon: 'pe-7s-attention',
                    message: "Erro ao cadastrar evento: Valor de extensão não pode ser abaixo de zero"
                },{
                    type: 'danger',
                    timer: 4000
                });
				return false;		
			}

			if(ensext.value < 0 || enspes.value < 0 || ensens.value < 0){
				//alert(msg);
				$.notify({
                    icon: 'pe-7s-attention',
                    message: "Erro ao cadastrar evento: Valor de ensino não pode ser abaixo de zero"
                },{
                    type: 'danger',
                    timer: 4000
                });
				return false;		
			}

			if(pesext.value < 0 || pespes.value < 0 || pesens.value < 0){
				//alert(msg);
				$.notify({
                    icon: 'pe-7s-attention',
                    message: "Erro ao cadastrar evento: Valor de pesquisa não pode ser abaixo de zero"
                },{
                    type: 'danger',
                    timer: 4000
                });
				return false;		
            }
            return true;
		}

        function VerificarData(data){
            console.log(data)
            if(data == ""){
                return false;
            }
            // else if(data < hoje()){
            //     console.log("data inferior");
            //     return false;
            // }
            return true;
        }

        function hoje(){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1;
            var yyyy = today.getFullYear();
            if(dd<10){
                dd='0'+dd;
            } 
            if(mm<10){
                mm='0'+mm;
            } 
            var today = yyyy+'-'+mm+'-'+dd;
            return today;
        }      

        function addEvent (){
            var ids = $('#cadastro input[id]').map(function() {
                return document.getElementById(this.id).value;
            }).get();

            var dados = {}

            dados.nome = ids[0]
            dados.data_inicio = ids[1]
            dados.data_fim = ids[2]
            dados.data_limite = parseInt(ids[3])
            dados.extensionista_extensao = parseInt(ids[4])
            dados.extensionista_pesquisa = parseInt(ids[5])
            dados.extensionista_ensino = parseInt(ids[6])
            dados.professor_extensao = parseInt(ids[7])
            dados.professor_pesquisa = parseInt(ids[8])
            dados.professor_ensino = parseInt(ids[9])
            dados.pesquisador_extensao = parseInt(ids[10])
            dados.pesquisador_pesquisa = parseInt(ids[11])
            dados.pesquisador_ensino = parseInt(ids[12])

            console.log(JSON.stringify(dados))

            $.ajax({
                url: '/api/events',
                dataType: 'text',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify(dados),
                success: function (data, textStatus, jQxhr) {
                    $.notify({
                        icon: 'pe-7s-like2',
                        message: "Evento Cadastrado Com Sucesso"
                    },{
                        type: 'info',
                        timer: 4000
                    });
                    return true;                    
                },
                error: function (jqXhr, textStatus, errorThrown) {
                    $.notify({
                        icon: 'pe-7s-attention',
                        message: "Erro ao cadastrar evento"
                    },{
                        type: 'danger',
                        timer: 4000
                    });
                    return false;
                }
            })


        }
    </script>
    
	<!-- Light Bootstrap Table DEMO methods, don't include it in your project!
    <script src="assets/js/demo.js"></script> -->
    


</html>
